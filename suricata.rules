alert icmp any any -> any any (msg:"ICMP Echo Request Detected"; itype:8; sid:1000001; rev:1; classtype:icmp-event; priority:3;)
# Phát hiện gói ICMP Echo Request (ping request) – dùng để giám sát hoặc phát hiện ping scan.

alert icmp any any -> any any (msg:"ICMP Echo Reply Detected"; itype:0; sid:1000002; rev:1; classtype:icmp-event; priority:3;)
# Phát hiện gói ICMP Echo Reply (ping reply) – phản hồi từ mục tiêu khi bị ping.

alert udp any any -> any 53 (msg:"DNS Query Detected (UDP to 53)"; content:"|01 00 00 01|"; sid:1000003; rev:1; classtype:bad-unknown; priority:3;)
# Phát hiện truy vấn DNS (UDP tới cổng 53) – dấu hiệu truy cập tên miền.

alert http any any -> $HOME_NET 80 (msg:"HTTP GET Request Detected"; flow:to_server,established; http.method; content:"GET"; sid:1000004; rev:1; classtype:protocol-command-decode; priority:3;)
# Phát hiện HTTP request với phương thức GET – thường dùng để tải nội dung từ web server.

alert http any any -> $HOME_NET 80 (msg:"HTTP POST Request Detected"; flow:to_server,established; http.method; content:"POST"; sid:1000005; rev:1; classtype:protocol-command-decode; priority:3;)
# Phát hiện HTTP POST – thường dùng để gửi dữ liệu form, có thể bị lợi dụng trong tấn công web.

alert http any any -> $HOME_NET 80 (msg:"HTTP User-Agent contains curl"; flow:to_server,established; http.user_agent; content:"curl"; nocase; sid:1000006; rev:1; classtype:policy-violation; priority:3;)
# Phát hiện User-Agent chứa “curl” – dấu hiệu của truy vấn tự động, script hoặc tool.

alert http any any -> $HOME_NET 80 (msg:"HTTP URI contains login"; flow:to_server,established; http.uri; content:"login"; nocase; sid:1000007; rev:1; classtype:web-application-activity; priority:3;)
# Phát hiện URI có chứa “login” – giúp SOC giám sát hoạt động đăng nhập.

alert udp any any -> any 53 (msg:"DNS Query for example.com"; content:"example.com"; sid:1000008; rev:1; classtype:bad-unknown; priority:3;)
# Phát hiện truy vấn DNS tới domain cụ thể example.com – ví dụ cho rule định danh domain.

alert tcp any any -> any 21 (msg:"FTP USER Command Detected"; flow:to_server,established; content:"USER "; nocase; sid:1000009; rev:1; classtype:attempted-admin; priority:3;)
# Phát hiện lệnh USER trong FTP – dấu hiệu đăng nhập FTP.

alert tcp any any -> any 22 (msg:"SSH Connection Attempt"; sid:1000010; rev:1; classtype:protocol-command-decode; priority:3;)
# Phát hiện kết nối SSH – có thể dùng làm baseline hoặc phát hiện brute-force.

alert http any any -> any any (msg:"HTTP Response 404 Not Found"; flow:to_client,established; content:"HTTP/1.1 404"; sid:1000011; rev:1; classtype:protocol-command-decode; priority:3;)
# Phát hiện HTTP response trả về lỗi 404 – hữu ích trong việc giám sát request bất thường.

alert udp any any -> any 53 (msg:"DNS Query Type TXT (heuristic)"; content:"v="; sid:1000012; rev:1; classtype:bad-unknown; priority:3;)
# Phát hiện DNS TXT record (dựa theo chuỗi “v=”) – thường thấy trong SPF/DKIM hoặc tunneling.

alert http any any -> any any (msg:"HTTP URI contains .php"; flow:to_server,established; http.uri; content:".php"; nocase; sid:1000013; rev:1; classtype:web-application-activity; priority:3;)
# Phát hiện truy cập trang PHP – phục vụ phát hiện tấn công web.

alert http any any -> any any (msg:"URI contains admin/root pattern"; flow:to_server,established; pcre:"/(admin|root)/Ui"; http.uri; sid:1000014; rev:1; classtype:web-application-activity; priority:3;)
# Dò URI có chứa admin hoặc root – dấu hiệu truy cập quản trị.

alert icmp any any -> any any (msg:"ICMP Flood (10 in 5s)"; detection_filter:track by_src, count 10, seconds 5; sid:1000015; rev:1; classtype:attempted-dos; priority:2;)
# Cảnh báo ICMP flood – 10 gói từ 1 IP trong 5 giây.

alert http any any -> any any (msg:"HTTP Header contains Authorization"; flow:to_server,established; http.header; content:"Authorization"; nocase; sid:1000016; rev:1; classtype:policy-violation; priority:3;)
# Phát hiện gói HTTP chứa header Authorization – dùng để giám sát rò rỉ token.

alert http any any -> any any (msg:"SQLMap User-Agent Detected"; flow:to_server,established; http.user_agent; content:"sqlmap"; nocase; sid:1000017; rev:1; classtype:web-application-attack; priority:2;)
# Phát hiện tool SQLMap – công cụ tấn công SQLi tự động.

alert tcp any any -> any 21 (msg:"FTP Login Attempt Detected"; flow:to_server,established; content:"USER "; nocase; sid:1000018; rev:1; classtype:attempted-admin; priority:3;)
# Phát hiện đăng nhập FTP – có thể dùng để theo dõi brute-force.

alert tcp any any -> any 25 (msg:"SMTP HELO Command Detected"; content:"HELO"; nocase; sid:1000019; rev:1; classtype:protocol-command-decode; priority:3;)
# Phát hiện lệnh HELO trong SMTP – khởi đầu phiên gửi email.

alert tls any any -> any any (msg:"TLS Client Hello Detected"; threshold:type limit, track by_src, count 1, seconds 300; sid:1000020; rev:1; classtype:protocol-command-decode; priority:3;)
# Phát hiện gói TLS ClientHello – dùng làm baseline TLS handshake.

alert tcp any any -> any 445 (msg:"SMB Protocol Access Detected"; sid:1000021; rev:1; classtype:protocol-command-decode; priority:3;)
# Phát hiện truy cập SMB (cổng 445) – thường dùng trong nội bộ Windows.

alert tcp any any -> any 22 (msg:"SSH Brute Force Attempt"; flow:to_server,established; threshold:type threshold, track by_src, count 5, seconds 30; sid:1000022; rev:1; classtype:attempted-admin; priority:2;)
# Phát hiện brute-force SSH – 5 lần kết nối trong 30s.

alert http any any -> any any (msg:"Possible Slowloris DoS Attack"; flow:established,to_server; http.method; content:"GET"; threshold:type both, track by_src, count 10, seconds 60; sid:1000023; rev:1; classtype:denial-of-service; priority:2;)
# Phát hiện Slowloris DoS – nhiều request GET giữ kết nối lâu.

alert udp any any -> any any (msg:"UDP Flood Detected"; flow:to_server; detection_filter:track by_dst, count 10, seconds 5; sid:1000024; rev:1; classtype:denial-of-service; priority:2;)
# Phát hiện UDP flood – nhiều gói UDP trong thời gian ngắn.

alert tcp any any -> any any (msg:"SYN Flood Detected"; flags:S; threshold:type both, track by_src, count 50, seconds 10; sid:1000025; rev:1; classtype:denial-of-service; priority:2;)
# Phát hiện SYN flood – 50 gói SYN trong 10s.

alert http any any -> $HOME_NET any (msg:"HTTP GET Flood to Server (>=200/30s)"; flow:established,to_server; http.method; content:"GET"; threshold:type threshold, track by_dst, count 200, seconds 30; sid:1000026; rev:1; classtype:attempted-dos; priority:2;)
# Phát hiện HTTP GET flood – tấn công DDoS HTTP.

alert http any any -> any any (msg:"SQL Injection Detected (CASE WHEN)"; flow:to_server,established; http.uri; content:"CASE WHEN"; nocase; sid:1000027; rev:1; classtype:web-application-attack; priority:1;)
# Phát hiện SQL Injection chứa “CASE WHEN”.

alert http any any -> any any (msg:"SQL Injection Detected (UNION SELECT)"; flow:to_server,established; pcre:"/UNION\s+SELECT/i"; sid:1000028; rev:1; classtype:web-application-attack; priority:1;)
# Phát hiện SQLi sử dụng UNION SELECT.

alert http any any -> any any (msg:"SQL Injection Detected (AND =)"; flow:to_server,established; http.uri; content:"AND ="; nocase; sid:1000029; rev:1; classtype:web-application-attack; priority:1;)
# Phát hiện SQLi dạng AND = (logic injection).

alert http any any -> any any (msg:"SQL Injection Boolean Pattern (AND 'A'='A')"; flow:to_server,established; http.uri; content:"AND 'A'='A'"; nocase; sid:1000030; rev:1; classtype:web-application-attack; priority:1;)
# Phát hiện SQLi kiểu Boolean True Condition.

alert smb any any -> any 445 (msg:"ETERNALBLUE SMB Exploit Attempt (heuristic)"; content:"AAAAAAAAAA"; nocase; flow:to_server,established; threshold:type threshold, track by_src, count 5, seconds 100; sid:1000031; rev:1; classtype:smb-buffer-overflow; priority:1;)
# Phát hiện ETERNALBLUE heuristic – dữ liệu SMB lặp lại bất thường.

alert http $HOME_NET any -> any any (msg:"HTTP Request Downloading .exe"; flow:to_server,established; http.method; content:"GET"; http.uri; content:".exe"; nocase; sid:1000032; rev:1; classtype:trojan-activity; priority:1;)
# Phát hiện tải file .exe qua HTTP – nghi ngờ malware download.

alert icmp any any -> any any (msg:"ICMP Anomaly - Oversized Packet (>1000 bytes)"; itype:8; dsize:>1000; sid:1000033; rev:1; classtype:icmp-event; priority:3;)
# Phát hiện gói ICMP kích thước lớn bất thường (>1000 bytes).

alert udp any any -> any 53 (msg:"DNS Tunneling Suspected (Base64 pattern)"; content:".com"; pcre:"/([A-Za-z0-9\/+]{50,}={0,2})/"; sid:1000034; rev:1; classtype:bad-unknown; priority:2;)
# Phát hiện DNS tunneling – chuỗi subdomain dài giống Base64.

alert http !$HOME_NET any -> $HOME_NET any (msg:"HTTP File Download Executable (MZ Header)"; file.data; content:"MZ"; depth:2; sid:1000035; rev:1; classtype:web-application-activity; priority:2;)
# Phát hiện tải file có header MZ (file .exe) về nội mạng.

alert telnet any any -> any any (msg:"TELNET Detected Login Prompt"; flow:established,to_client; content:"login:"; nocase; sid:1000036; rev:1; classtype:attempted-admin; priority:3;)
# Phát hiện prompt đăng nhập Telnet.

alert tcp any any -> any any (msg:"Command Injection Attempt (pipe whoami or semicolon id)"; flow:to_server,established; content:"\;whoami"; nocase; sid:1000037; rev:1; classtype:web-application-attack; priority:1;)
# Phát hiện Command Injection – chuỗi “;whoami” hoặc lệnh hệ thống.

alert http any any -> any any (msg:"LFI Attempt Detected (../../etc/passwd)"; flow:to_server,established; http.uri; content:"../../etc/passwd"; nocase; sid:1000038; rev:1; classtype:web-application-attack; priority:1;)
# Phát hiện Local File Inclusion – truy cập file /etc/passwd.

alert udp any any -> any 53 (msg:"DNS Query Domain too long (>50 chars) (heuristic)"; content:"."; pcre:"/.{50,}/"; sid:1000039; rev:1; classtype:bad-unknown; priority:3;)
# Phát hiện domain DNS có độ dài bất thường >50 ký tự – nghi tunneling.

alert http any any -> any any (msg:"HTTP Header Contains Base64 Encoded cmd.exe"; file.data; content:"Y21kLmV4ZQ=="; sid:1000040; rev:1; classtype:trojan-activity; priority:2;)
# Phát hiện payload mã hóa Base64 chứa “cmd.exe”.

alert http !$HOME_NET any -> $HOME_NET any (msg:"Suspicious Admin Login from External IP"; flow:to_server,established; http.uri; content:"/admin"; nocase; sid:1000041; rev:1; classtype:attempted-admin; priority:1;)
# Phát hiện truy cập trang quản trị từ IP ngoài mạng nội bộ.

alert http any any -> any any (msg:"Access to .onion Domain"; http.host; content:".onion"; sid:1000042; rev:1; classtype:policy-violation; priority:2;)
# Phát hiện truy cập domain .onion – liên quan mạng Tor.

alert http any any -> any any (msg:"Access to Suspicious Keyword 'hacker' in URL"; http.uri; content:"hacker"; nocase; sid:1000043; rev:1; classtype:web-application-activity; priority:3;)
# Phát hiện URI chứa từ khóa hacker – dấu hiệu tìm kiếm nguy hiểm.

alert http any any -> any any (msg:"Download File with Content-Type application/x-msdownload"; flow:to_client,established; http.header; content:"application/x-msdownload"; nocase; sid:1000044; rev:1; classtype:trojan-activity; priority:2;)
# Phát hiện tải file thực thi Windows qua HTTP.

alert udp any any -> any 53 (msg:"DNS Response Contains Localhost IP (127.0.0.1)"; content:"|7F 00 00 01|"; sid:1000045; rev:1; classtype:bad-unknown; priority:3;)
# Phát hiện DNS response trả về IP 127.0.0.1 – có thể là độc hại hoặc sai cấu hình.

alert tls any any -> any any (msg:"TLS ClientHello SNI Contains 'malware'"; tls.sni; content:"malware"; nocase; sid:1000046; rev:1; classtype:bad-unknown; priority:2;)
# Phát hiện SNI trong TLS ClientHello chứa từ “malware”.

alert tcp any any -> any 3389 (msg:"RDP Brute Force Detected"; detection_filter:track by_src, count 10, seconds 30; sid:1000047; rev:1; classtype:attempted-admin; priority:2;)
# Phát hiện brute-force RDP – nhiều lần kết nối trong thời gian ngắn.

alert smb any any -> any 445 (msg:"SMB Access to Sensitive File secret.docx"; file.name; content:"secret.docx"; sid:1000048; rev:1; classtype:bad-unknown; priority:2;)
# Phát hiện truy cập file nhạy cảm “secret.docx” qua SMB.

alert http any any -> any any (msg:"HTTP Download ZIP File"; http.uri; content:".zip"; nocase; sid:1000049; rev:1; classtype:web-application-activity; priority:3;)
# Phát hiện tải file .zip – thường dùng trong exfiltration.

alert http any any -> any any (msg:"HTTP User-Agent Botnet Pattern python-requests"; http.user_agent; content:"python-requests"; nocase; sid:1000050; rev:1; classtype:trojan-activity; priority:2;)
# Phát hiện botnet hoặc script Python (User-Agent chứa python-requests).
